<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>Catálogo de Productos - Administrador</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
	<link rel="icon" type="image/png" href="https://scontent.flim2-2.fna.fbcdn.net/v/t39.30808-6/449786601_1008536607945872_2181997208535490316_n.jpg?_nc_cat=103&ccb=1-7&_nc_sid=6ee11a&_nc_eui2=AeE_ZiAfq-a_2hBeIcZ4yCvUXgBEZEwNVsleAERkTA1WyTpVK4l6pUv5cGKHl7livEaWmeqRfSVVnwmW97i-XHJS&_nc_ohc=G2QTUvrinaoQ7kNvwERlexv&_nc_oc=Adkq7X5VGC8yxm9e4ESEJ4Fcq6miQX8GS6NdIq5ao8pG3Os5aacJvN2QZfIp1OU3d6nrsMUx5cBBrM6gh81hMN0h&_nc_zt=23&_nc_ht=scontent.flim2-2.fna&_nc_gid=i6VlML3ELqSeg6zAA-nLfA&oh=00_AfOAuSUtSy3PxvFh7PTnT7lCPtX99dK44a8x1plPHvPRDA&oe=686CE1EF">

	<style>
		:root {
			--primary-color: #1b263b;
			--secondary-color: #0d1b2a;
			--accent-color: #28a745;
			--light-bg: #f8f9fa;
			--card-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
			--gradient-primary: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
			--gradient-accent: linear-gradient(135deg, var(--accent-color), #20c997);
			--text-light: #ffffff;
			--text-dark: #2c3e50;
			--text-muted: #6c757d;
		}

		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			background: linear-gradient(135deg, #f0f4ff 0%, #b8c6db 100%);
			font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
			min-height: 100vh;
			margin: 0;
			padding: 0;
		}

		.admin-header {
			background: var(--gradient-primary);
			color: var(--text-light);
			padding: 2rem 0;
			position: relative;
			overflow: hidden;
		}

		.admin-header::before {
			content: '';
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="10" cy="60" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="90" cy="40" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
			opacity: 0.3;
		}

		.admin-header .container {
			position: relative;
			z-index: 2;
		}

		.admin-badge {
			display: inline-flex;
			align-items: center;
			gap: 0.5rem;
			background: rgba(255, 255, 255, 0.15);
			backdrop-filter: blur(10px);
			padding: 0.5rem 1rem;
			border-radius: 50px;
			font-size: 0.9rem;
			font-weight: 500;
			margin-bottom: 1rem;
			border: 1px solid rgba(255, 255, 255, 0.2);
		}

		.header-title {
			font-size: 3rem;
			font-weight: 800;
			margin-bottom: 0.5rem;
			text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
			letter-spacing: -0.5px;
		}

		.header-subtitle {
			font-size: 1.2rem;
			opacity: 0.9;
			font-weight: 300;
		}

		.controls-section {
			background: #e9ecef;
			padding: 2rem 0;
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
			border-bottom: 1px solid #e9ecef;
		}

		.search-container {
			max-width: 600px;
			margin: 0 auto;
			position: relative;
		}

		.search-input {
			background: #ffffff;
			border: 2px solid #e9ecef;
			border-radius: 50px;
			padding: 1rem 3rem 1rem 1.5rem;
			font-size: 1rem;
			transition: all 0.3s ease;
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
			width: 100%;
		}

		.search-input:focus {
			border-color: var(--primary-color);
			box-shadow: 0 0 0 4px rgba(27, 38, 59, 0.1);
			outline: none;
			transform: translateY(-2px);
		}

		.search-icon {
			position: absolute;
			right: 1.5rem;
			top: 50%;
			transform: translateY(-50%);
			color: var(--text-muted);
			font-size: 1.1rem;
		}

		.add-product-btn {
			background: var(--gradient-accent);
			border: none;
			padding: 0.8rem 2rem;
			border-radius: 25px;
			color: white;
			font-weight: 600;
			font-size: 0.95rem;
			transition: all 0.3s ease;
			box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
			display: inline-flex;
			align-items: center;
			gap: 0.5rem;
		}

		.add-product-btn:hover {
			transform: translateY(-2px);
			box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
			color: white;
		}

		.products-grid {
			padding: 3rem 0;
		}

		.product-card {
			background: white;
			border: none;
			border-radius: 20px;
			overflow: hidden;
			transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
			box-shadow: var(--card-shadow);
			height: 100%;
			position: relative;
		}

		.product-card:hover {
			transform: translateY(-10px);
			box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
		}

		.product-image {
			height: 250px;
			object-fit: cover;
			transition: transform 0.4s ease;
			width: 100%;
		}

		.product-card:hover .product-image {
			transform: scale(1.05);
		}

		.card-body {
			padding: 1.5rem;
			display: flex;
			flex-direction: column;
			justify-content: space-between;
			min-height: 250px;
		}

		.product-title {
			font-size: 1.25rem;
			font-weight: 700;
			color: var(--primary-color);
			margin-bottom: 0.75rem;
			line-height: 1.3;
		}

		.product-description {
			color: var(--text-muted);
			font-size: 0.9rem;
			margin-bottom: 1rem;
			flex-grow: 1;
			display: -webkit-box;
			-webkit-line-clamp: 3;
			-webkit-box-orient: vertical;
			overflow: hidden;
		}

		.product-price {
			font-size: 1.5rem;
			font-weight: 700;
			color: var(--accent-color);
			margin-bottom: 1.5rem;
			display: flex;
			align-items: center;
			gap: 0.5rem;
		}

		.price-label {
			font-size: 0.9rem;
			font-weight: 500;
			color: var(--text-muted);
		}

		.action-buttons {
			display: flex;
			gap: 0.5rem;
		}

		.btn-edit {
			background: linear-gradient(135deg, #ffc107, #ff8c00);
			border: none;
			color: white;
			padding: 0.6rem 1.2rem;
			border-radius: 10px;
			font-weight: 500;
			transition: all 0.3s ease;
			flex: 1;
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 0.3rem;
			font-size: 0.85rem;
		}

		.btn-edit:hover {
			transform: translateY(-2px);
			box-shadow: 0 4px 15px rgba(255, 193, 7, 0.4);
			color: white;
		}

		.btn-delete {
			background: linear-gradient(135deg, #dc3545, #c82333);
			border: none;
			color: white;
			padding: 0.6rem 1.2rem;
			border-radius: 10px;
			font-weight: 500;
			transition: all 0.3s ease;
			flex: 1;
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 0.3rem;
			font-size: 0.85rem;
		}

		.btn-delete:hover {
			transform: translateY(-2px);
			box-shadow: 0 4px 15px rgba(220, 53, 69, 0.4);
			color: white;
		}

		.no-products {
			text-align: center;
			padding: 4rem 2rem;
			background: white;
			border-radius: 20px;
			box-shadow: var(--card-shadow);
			margin: 2rem 0;
		}

		.no-products-icon {
			font-size: 4rem;
			color: var(--text-muted);
			margin-bottom: 1rem;
		}

		.no-products-title {
			font-size: 1.5rem;
			font-weight: 600;
			color: var(--text-dark);
			margin-bottom: 0.5rem;
		}

		.no-products-text {
			color: var(--text-muted);
			font-size: 1rem;
		}

		.back-section {
			background: var(--gradient-primary);
			padding: 2rem 0;
			margin-top: 3rem;
		}

		.btn-back {
			background: rgba(255, 255, 255, 0.15);
			backdrop-filter: blur(10px);
			border: 1px solid rgba(255, 255, 255, 0.2);
			color: white;
			padding: 0.8rem 2rem;
			border-radius: 25px;
			font-weight: 500;
			transition: all 0.3s ease;
			display: inline-flex;
			align-items: center;
			gap: 0.5rem;
			text-decoration: none;
		}

		.btn-back:hover {
			background: rgba(255, 255, 255, 0.25);
			transform: translateY(-2px);
			color: white;
		}

		.stats-card {
			background: white;
			padding: 1.5rem;
			border-radius: 15px;
			box-shadow: var(--card-shadow);
			text-align: center;
			transition: transform 0.3s ease;
		}

		.stats-card:hover {
			transform: translateY(-5px);
		}

		.stats-number {
			font-size: 2rem;
			font-weight: 700;
			color: var(--primary-color);
			margin-bottom: 0.5rem;
		}

		.stats-label {
			color: var(--text-muted);
			font-size: 0.9rem;
			font-weight: 500;
		}

		@keyframes fadeInUp {
			from {
				opacity: 0;
				transform: translateY(30px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		.fade-in-up {
			animation: fadeInUp 0.6s ease-out;
		}

		@media (max-width: 768px) {
			.header-title {
				font-size: 2rem;
			}

			.header-subtitle {
				font-size: 1rem;
			}

			.controls-section {
				padding: 1.5rem 0;
			}

			.search-input {
				padding: 0.8rem 2.5rem 0.8rem 1rem;
			}

			.add-product-btn {
				width: 100%;
				margin-top: 1rem;
				justify-content: center;
			}

			.product-image {
				height: 200px;
			}

			.card-body {
				padding: 1.25rem;
				min-height: auto;
			}

			.action-buttons {
				flex-direction: column;
			}

			.btn-edit,
			.btn-delete {
				width: 100%;
			}
		}

		/* Scrollbar personalizada */
		::-webkit-scrollbar {
			width: 8px;
		}

		::-webkit-scrollbar-track {
			background: #f1f1f1;
		}

		::-webkit-scrollbar-thumb {
			background: var(--primary-color);
			border-radius: 4px;
		}

		::-webkit-scrollbar-thumb:hover {
			background: var(--secondary-color);
		}
	</style>
</head>
<body>
<!-- Header del Administrador -->
<header class="admin-header">
	<div class="container">
		<div class="admin-badge">
			<i class="fas fa-crown"></i>
			Panel de Administrador
		</div>
		<h1 class="header-title">Gestión de Productos</h1>
		<p class="header-subtitle">Administra tu catálogo de comidas de manera eficiente</p>
	</div>
</header>

<!-- Sección de Controles -->
<section class="controls-section">
	<div class="container">
		<div class="row align-items-center">
			<div class="col-lg-8">
				<div class="search-container">
					<input type="text" id="searchInput" class="search-input" placeholder="Buscar productos por nombre o descripción...">
					<i class="fas fa-search search-icon"></i>
				</div>
			</div>
			<div class="col-lg-4 text-lg-end">
				<a th:href="@{/vistas/productos/registrar}" class="add-product-btn">
					<i class="fas fa-plus"></i>
					Agregar Producto
				</a>
			</div>
		</div>

		<!-- Estadísticas -->
		<div class="row mt-4">
			<div class="col-md-4">
				<div class="stats-card">
					<div class="stats-number" id="totalProducts">0</div>
					<div class="stats-label">Total de Productos</div>
				</div>
			</div>
			<div class="col-md-4">
				<div class="stats-card">
					<div class="stats-number" id="activeProducts">0</div>
					<div class="stats-label">Productos Activos</div>
				</div>
			</div>
			<div class="col-md-4">
				<div class="stats-card">
					<div class="stats-number" id="avgPrice">S/ 0.00</div>
					<div class="stats-label">Precio Promedio</div>
				</div>
			</div>
		</div>
	</div>
</section>

<!-- Grid de Productos -->
<section class="products-grid">
	<div class="container">
		<!-- Mensaje cuando no hay productos -->
		<div class="row" th:if="${#lists.isEmpty(productos)}">
			<div class="col-12">
				<div class="no-products fade-in-up">
					<div class="no-products-icon">
						<i class="fas fa-utensils"></i>
					</div>
					<h3 class="no-products-title">No hay productos disponibles</h3>
					<p class="no-products-text">Comienza agregando tu primer producto al catálogo</p>
				</div>
			</div>
		</div>

		<!-- Lista de productos -->
		<div class="row" id="productList">
			<div class="col-xl-3 col-lg-4 col-md-6 mb-4 product-item fade-in-up" th:each="p : ${productos}">
				<div class="product-card">
					<img class="product-image"
						 th:src="${p.imagenUrl != null and p.imagenUrl != ''} ? ${p.imagenUrl} : 'https://via.placeholder.com/300x250/1b263b/ffffff?text=Sin+Imagen'"
						 th:alt="'Imagen de ' + ${p.nombre}">

					<div class="card-body">
						<h5 class="product-title" th:text="${p.nombre}">Nombre del Producto</h5>
						<p class="product-description" th:text="${p.descripcion != null} ? ${p.descripcion} : 'Sin descripción disponible'">
							Descripción del producto
						</p>

						<div class="product-price">
							<span class="price-label">Precio:</span>
							<span>S/ <span th:text="${#numbers.formatDecimal(p.precio, 1, 2)}">0.00</span></span>
						</div>

						<div class="action-buttons">
							<a th:href="@{/vistas/productos/editar/{id}(id=${p.idproducto})}" class="btn-edit">
								<i class="fas fa-edit"></i>
								Editar
							</a>
							<a th:href="@{/vistas/productos/eliminar/{id}(id=${p.idproducto})}"
							   class="btn-delete"
							   onclick="return confirm('¿Estás seguro de eliminar este producto?');">
								<i class="fas fa-trash-alt"></i>
								Eliminar
							</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<!-- Sección de Regreso -->
<section class="back-section">
	<div class="container text-center">
		<a th:href="@{/}" class="btn-back">
			<i class="fas fa-arrow-left"></i>
			Regresar al inicio
		</a>
	</div>
</section>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
	$(document).ready(function() {
		// Funcionalidad de búsqueda mejorada
		$('#searchInput').on('input', function() {
			const searchTerm = $(this).val().toLowerCase().trim();
			let visibleCount = 0;

			$('.product-item').each(function() {
				const productName = $(this).find('.product-title').text().toLowerCase();
				const productDescription = $(this).find('.product-description').text().toLowerCase();

				if (productName.includes(searchTerm) || productDescription.includes(searchTerm)) {
					$(this).show().addClass('fade-in-up');
					visibleCount++;
				} else {
					$(this).hide().removeClass('fade-in-up');
				}
			});

			// Mostrar mensaje si no hay resultados
			if (visibleCount === 0 && searchTerm !== '') {
				if ($('#noResults').length === 0) {
					$('#productList').append(`
                            <div class="col-12" id="noResults">
                                <div class="no-products">
                                    <div class="no-products-icon">
                                        <i class="fas fa-search"></i>
                                    </div>
                                    <h3 class="no-products-title">No se encontraron productos</h3>
                                    <p class="no-products-text">Intenta con otros términos de búsqueda</p>
                                </div>
                            </div>
                        `);
				}
			} else {
				$('#noResults').remove();
			}
		});

		// Calcular estadísticas
		function updateStats() {
			const totalProducts = $('.product-item').length;
			const activeProducts = $('.product-item:visible').length;

			let totalPrice = 0;
			$('.product-item').each(function() {
				const priceText = $(this).find('.product-price span:last').text();
				const price = parseFloat(priceText.replace('S/ ', '').replace(',', ''));
				if (!isNaN(price)) {
					totalPrice += price;
				}
			});

			const avgPrice = totalProducts > 0 ? (totalPrice / totalProducts).toFixed(2) : 0;

			$('#totalProducts').text(totalProducts);
			$('#activeProducts').text(activeProducts);
			$('#avgPrice').text('S/ ' + avgPrice);
		}

		updateStats();

		// Animaciones al hacer scroll
		function animateOnScroll() {
			$('.fade-in-up').each(function() {
				const elementTop = $(this).offset().top;
				const windowBottom = $(window).scrollTop() + $(window).height();

				if (elementTop < windowBottom - 100) {
					$(this).addClass('animate');
				}
			});
		}

		$(window).on('scroll', animateOnScroll);
		animateOnScroll();

		// Efectos de hover mejorados
		$('.product-card').hover(
				function() {
					$(this).find('.product-image').css('transform', 'scale(1.05)');
				},
				function() {
					$(this).find('.product-image').css('transform', 'scale(1)');
				}
		);

		// Confirmación mejorada para eliminar
		$('.btn-delete').on('click', function(e) {
			e.preventDefault();
			const productName = $(this).closest('.product-card').find('.product-title').text();

			if (confirm('¿Estás seguro de eliminar "' + productName + '"?\n\nEsta acción no se puede deshacer.')) {
				window.location.href = $(this).attr('href');
			}
		});

	});
</script>
</body>
</html>